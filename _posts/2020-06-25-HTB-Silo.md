---
title:     "Hack The Box - Silo"
tags: [windows,medium]
categories: HackTheBox
---

![1.jpg](https://raw.githubusercontent.com/an4kein/an4kein.github.io/master/img/htb-silo/1.jpg)

## Enumeration

Iniciamos como sempre o nmap para pegarmos informacoes sobre nosso alvo 

```
┌─[htb-an4kein☺parrot]─[~/htb/silo]
└──╼ $sudo nmap --top-ports 30 -sV -oN nmap/topportstcp 10.10.10.82
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-25 23:49 UTC
Nmap scan report for 10.10.10.82
Host is up (0.16s latency).
Not shown: 26 closed ports
PORT    STATE SERVICE      VERSION
80/tcp  open  http         Microsoft IIS httpd 8.5
135/tcp open  msrpc        Microsoft Windows RPC
139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
Service Info: OSs: Windows, q; CPE: cpe:/o:microsoft:windows
```

Continuando a enumeracao em busca de vulns, usando o proprio nmap e seus scripts para tentar trazer algoo interessante..

```
┌─[htb-an4kein☺parrot]─[~/htb/silo]
└──╼ $nmap -p80,135,139,445 --script vuln 10.10.10.82 -oN nmap/vulns
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-25 23:53 UTC
Stats: 0:00:35 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 76.32% done; ETC: 23:53 (0:00:07 remaining)
Stats: 0:01:36 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.95% done; ETC: 23:54 (0:00:01 remaining)
Nmap scan report for 10.10.10.82
Host is up (0.45s latency).

PORT    STATE SERVICE                                                          
80/tcp  open  http                 
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
|_http-csrf: Couldn't find any CSRF vulnerabilities.
|_http-dombased-xss: Couldn't find any DOM based XSS.
|_http-stored-xss: Couldn't find any stored XSS vulnerabilities.
135/tcp open  msrpc
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
139/tcp open  netbios-ssn
|_clamav-exec: ERROR: Script execution failed (use -d to debug)
445/tcp open  microsoft-ds
|_clamav-exec: ERROR: Script execution failed (use -d to debug)

Host script results:
|_samba-vuln-cve-2012-1182: No accounts left to try
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: No accounts left to try

```

Nada muito obvio ate o momento precisamos continuar enumerando, agora vou enumerar cada porta individualmente..

Na porta 80 temos um IIS, posteriormente vou usar o  `gobuster` em busca de files/dir que possa ser uma porta de entrada

![2.jpg](https://raw.githubusercontent.com/an4kein/an4kein.github.io/master/img/htb-silo/2.jpg)

Enquanto o gobuster esta rodando, vamos enumerar as outras portas

```
┌─[htb-an4kein☺parrot]─[~/htb/silo]                                                                                                                    [0/127]
└──╼ $sudo gobuster dir -w /opt/SecLists/Discovery/Web-Content/SVNDigger/all.txt -u http://10.10.10.82/ -o gobuster-root.txt
===============================================================                                                                                               
Gobuster v3.0.1                    
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)             
===============================================================      
[+] Url:            http://10.10.10.82/                                        
[+] Threads:        10                                                         
[+] Wordlist:       /opt/SecLists/Discovery/Web-Content/SVNDigger/all.txt
[+] Status codes:   200,204,301,302,307,401,403                                
[+] User Agent:     gobuster/3.0.1                                             
[+] Timeout:        10s                                                        
===============================================================                
2020/06/26 00:21:51 Starting gobuster                                          
===============================================================      
/????.txt (Status: 200)            
/??.txt (Status: 200)                                                          
/?? (Status: 200)                                                              
[ERROR] 2020/06/26 00:24:15 [!] parse http://10.10.10.82/%%45^45E^45E480CD%%index.tpl.php: invalid URL escape "%%4"                                           
/???? (Status: 200)                                                            
[ERROR] 2020/06/26 00:24:38 [!] parse http://10.10.10.82/%%F7^F7F^F7F34188%%header.tpl.php: invalid URL escape "%%F"                                          
[ERROR] 2020/06/26 00:24:53 [!] parse http://10.10.10.82/%%0E^0E4^0E407559%%footer.tpl.php: invalid URL escape "%%0"                                          
Progress: 8084 / 43135 (18.74%)           
```

Continuando..

Uma enumeracao rapida usando apenas -a do enum4linux nao trouxe muita coisa, 

```
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Fri Jun 26 01:18:24 2020

 ========================== 
|    Target Information    |
 ========================== 
Target ........... 10.10.10.82
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 =================================================== 
|    Enumerating Workgroup/Domain on 10.10.10.82    |
 =================================================== 
[E] Can't find workgroup/domain


 =========================================== 
|    Nbtstat Information for 10.10.10.82    |
 =========================================== 
Looking up status of 10.10.10.82
No reply from 10.10.10.82

 ==================================== 
|    Session Check on 10.10.10.82    |
 ==================================== 
[E] Server doesn't allow session using username '', password ''.  Aborting remainder of tests.
```
Mas, olhdando com calma o que ja conseguimos.. sabemos que o sistema operacional eh um windows e que pode ser 2008 ou 2012 `Windows Server 2008 R2 - 2012` , entao podemos pesquisar por alguns exploits futuramente..

Preciso enumerar mais..

```
─[htb-an4kein☺parrot]─[~/htb/silo]                                                                                                                      [2/2]
└──╼ $sudo nmap -p139,445 --script smb-vuln-* 10.10.10.82                       
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 01:26 UTC
Nmap scan report for 10.10.10.82
Host is up (0.21s latency).
                                       
PORT    STATE SERVICE     
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds
                                       
Host script results:                                                           
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)
                                       
Nmap done: 1 IP address (1 host up) scanned in 13.91 seconds    
┌─[htb-an4kein☺parrot]─[~/htb/silo]                                            
└──╼ $sudo nmap -p139,445 --script smb-enum-* 10.10.10.82                       
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 01:26 UTC
Nmap scan report for 10.10.10.82
Host is up (0.21s latency).
                                       
PORT    STATE SERVICE                                                          
139/tcp open  netbios-ssn 
|_smb-enum-services: ERROR: Script execution failed (use -d to debug)
445/tcp open  microsoft-ds
|_smb-enum-services: ERROR: Script execution failed (use -d to debug)
                                       
Nmap done: 1 IP address (1 host up) scanned in 15.67 seconds
```

Continuamos..

```
┌─[htb-an4kein☺parrot]─[~/htb/silo]                                            
└──╼ $sudo nmap -O -oN nmap/os 10.10.10.82                                 
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 01:28 UTC            
Nmap scan report for 10.10.10.82                                               
Host is up (0.21s latency).                                                    
Not shown: 988 closed ports                                                    
PORT      STATE SERVICE
80/tcp    open  http    
135/tcp   open  msrpc
139/tcp   open  netbios-ssn                                                                                                                                   
445/tcp   open  microsoft-ds                                                   
1521/tcp  open  oracle             
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown
49158/tcp open  unknown
49160/tcp open  unknown
49161/tcp open  unknown
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.80%E=4%D=6/26%OT=80%CT=1%CU=31873%PV=Y%DS=2%DC=I%G=Y%TM=5EF54F6
OS:1%P=x86_64-pc-linux-gnu)SEQ(SP=FF%GCD=1%ISR=10D%TI=I%CI=I%II=I%TS=7)SEQ(
OS:SP=FF%GCD=1%ISR=10D%TI=I%CI=I%II=I%SS=S%TS=7)OPS(O1=M54DNW8ST11%O2=M54DN
OS:W8ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11)WIN(W1=
OS:2000%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=
OS:M54DNW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=
OS:80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0
OS:%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z
OS:%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y
OS:%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%UN=0%RI
OS:PL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%CD=Z)
```
Interessante, encontramos uma nova porta `1521/tcp  open  oracle`, e vamos em busca de obter mais informacoes
```
┌─[htb-an4kein☺parrot]─[~/htb/silo]                                                                                                                           
└──╼ $sudo nmap -sV -sC -p80,135,139,445,1521 -oN nmap/ports_set 10.10.10.82                                                                                  
Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-26 01:36 UTC                                                                                               
Nmap scan report for 10.10.10.82                                                                                                                              
Host is up (0.21s latency).                                                                                                                                   
                                                                                                                                                              
PORT     STATE SERVICE      VERSION                                                                                                                           
80/tcp   open  http         Microsoft IIS httpd 8.5                                                                                                           
| http-methods:                                                                                                                                               
|_  Potentially risky methods: TRACE                                           
|_http-server-header: Microsoft-IIS/8.5                                    
|_http-title: IIS Windows Server                                               
135/tcp  open  msrpc        Microsoft Windows RPC                          
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn                  
445/tcp  open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1521/tcp open  oracle-tns   Oracle TNS listener 11.2.0.2.0 (unauthorized)
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:                                                                                                                                          
|_clock-skew: mean: -6s, deviation: 0s, median: -7s         
|_smb-os-discovery: ERROR: Script execution failed (use -d to debug)
| smb-security-mode:                                                                                                                                          
|   authentication_level: user     
|   challenge_response: supported
|_  message_signing: supported
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2020-06-26T01:36:44
|_  start_date: 2020-06-25T06:31:52
```

## Exploitation

Resolvi entao pesquisar mais sobre esse servico no qual estava rodando na porta 1521 `Oracle TNS listener 11.2.0.2.0 (unauthorized)`

![3.jpg](https://raw.githubusercontent.com/an4kein/an4kein.github.io/master/img/htb-silo/3.jpg)

Algumas pesquisa me levaram alguns ataques no qual eu preciso testar e ver se vai surtir efeito...

***reference*** https://www.cybersecurity-help.cz/vdb/SB2012041801 - https://www.securityfocus.com/bid/53308  - https://github.com/bongbongco/CVE-2012-1675 - https://github.com/quentinhardy/odat/wiki/tnspoison

![4.jpg](https://raw.githubusercontent.com/an4kein/an4kein.github.io/master/img/htb-silo/4.jpg)


Vamos, la explorar esse servico...


